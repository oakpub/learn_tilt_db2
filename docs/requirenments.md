# Техническое Задание: Демонстрационный стенд для микросервисной разработки

## 1. Цель проекта

Создать прототип окружения для локальной разработки и запуска мультисервисного приложения. Окружение должно обеспечивать быструю обратную связь для разработчиков (live-reloading) и использовать декларативный подход к описанию инфраструктуры. Ключевая особенность — возможность гибко конфигурировать состав запускаемых сервисов и их зависимостей (включая базы данных) для различных сред (локальная, staging, prod).

## 2. Технологический стек

- **Оркестрация:** Kubernetes (в локальном кластере)
- **Шаблонизация:** Helm 3
- **Среда разработки:** Tilt
- **Контейнеризация:** Docker
- **База данных:** PostgreSQL

## 3. Ключевые требования

- **Централизованная конфигурация:** Управление всеми компонентами системы осуществляется через единый Helm-чарт.
- **Гибкий состав сервисов:** Возможность включать или отключать развертывание любого микросервиса через конфигурационный файл (`values.yaml`).
- **Поддержка окружений:** Архитектура должна позволять использовать разные конфигурации для разных сред (например, `local`, `staging`, `prod`) с помощью отдельных `values-*.yaml` файлов.
- **Опциональная база данных:**
  - Для локальной разработки должна быть возможность поднять локальный экземпляр PostgreSQL.
  - Для других сред (staging/prod) должна быть возможность отключить создание локальной БД и настроить подключение к внешней, управляемой базе данных.
- **Быстрая разработка:** Использование Tilt для автоматической пересборки и обновления сервисов в Kubernetes при изменении их исходного кода.
- **Разделение ответственности:** Четкое разделение исходного кода приложений (`services/`) и инфраструктурной конфигурации (`helm/`).

## 4. План реализации

1.  **Инициализация проекта:** Создать структуру папок и файлов согласно архитектурному дизайну.
2.  **Создание микросервисов:** Разработать 2-3 простых веб-сервиса (например, на Python/Flask или Node.js/Express), которые будут служить в качестве примера.
3.  **Контейнеризация:** Подготовить `Dockerfile` для каждого микросервиса.
4.  **Создание Helm-чарта:**
    - Инициализировать центральный Helm-чарт в директории `helm/app`.
    - Организовать шаблоны в подпапках, соответствующих каждому сервису (`templates/service-a/`, `templates/postgresql/`).
    - Реализовать в `values.yaml` флаги для включения/отключения сервисов и локальной БД.
    - Создать пример файла `values-prod.yaml` для демонстрации переопределения конфигурации.
5.  **Настройка Tilt:**
    - Создать `Tiltfile` в корне проекта.
    - Настроить в нем логику сборки Docker-образов.
    - Реализовать вызов Helm с применением соответствующего файла `values` в зависимости от выбранного окружения.
    - Настроить live-update для сервисов.
6.  **Документация:** Подготовить `README.md` с инструкциями по запуску проекта и добавлению новых сервисов.
